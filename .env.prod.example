# Production Environment Configuration
# Copy to .env.prod and fill in actual values
# NEVER commit .env.prod to git

# ============================================================================
# DATABASE (PostgreSQL)
# ============================================================================

# Use a strong random password: openssl rand -base64 32
DB_PASSWORD=CHANGE_ME_STRONG_PASSWORD

# Full connection string (auto-constructed from DB_PASSWORD)
# For managed PostgreSQL, replace with provider's connection string
DATABASE_URL=postgresql://labelverify:${DB_PASSWORD}@postgres:5432/labelverify_prod

# ============================================================================
# REDIS (Job Queue)
# ============================================================================

# Use a strong random password: openssl rand -base64 32
REDIS_PASSWORD=CHANGE_ME_STRONG_PASSWORD

# Full connection string (auto-constructed from REDIS_PASSWORD)
# For managed Redis, replace with provider's connection string
REDIS_URL=redis://:${REDIS_PASSWORD}@redis:6379

# ============================================================================
# CLOUDFLARE - Workers AI
# ============================================================================

# Your Cloudflare account ID
CF_ACCOUNT_ID=your_production_account_id

# Production API token (scoped: Workers AI Read, Account Read)
# Generate at: https://dash.cloudflare.com/profile/api-tokens
CF_API_TOKEN=your_production_api_token

# ============================================================================
# CLOUDFLARE - R2 Storage
# ============================================================================

# Production bucket name
R2_BUCKET=label-verify-prod

# R2 API credentials (scoped to production bucket only)
R2_ACCESS_KEY=your_production_r2_access_key
R2_SECRET_KEY=your_production_r2_secret_key

# R2 endpoint (replace with your account ID)
R2_ENDPOINT=https://your_account_id.r2.cloudflarestorage.com

# ============================================================================
# ENCRYPTION
# ============================================================================

# CRITICAL: Generate NEW key for production
# Generate with: openssl rand -base64 32
# NEVER reuse development key
# BACKUP THIS KEY SECURELY - cannot decrypt without it
ENCRYPTION_KEY=CHANGE_ME_NEW_PRODUCTION_KEY

# ============================================================================
# ============================================================================



# ============================================================================
# SERVER
# ============================================================================

# Bind address (keep as 0.0.0.0:3000 for Docker)
BIND_ADDR=0.0.0.0:3000

# Log level (info, debug, warn, error)
RUST_LOG=info

# ============================================================================
# CLOUDFLARE TUNNEL (HTTPS)
# ============================================================================

# Tunnel token (get from: cloudflared tunnel token <tunnel-name>)
#
# Setup steps:
# 1. Install cloudflared: brew install cloudflare/cloudflare/cloudflared
# 2. Authenticate: cloudflared tunnel login
# 3. Create tunnel: cloudflared tunnel create label-verify-hw
# 4. Route DNS: cloudflared tunnel route dns label-verify-hw api.yourdomain.com
# 5. Get token: cloudflared tunnel token label-verify-hw
# 6. Add token below and uncomment
#
# TUNNEL_TOKEN=your_tunnel_token_here
#
# Domain name for tunnel (for documentation/reference)
# DOMAIN_NAME=api.yourdomain.com

# ============================================================================
# MONITORING (Optional)
# ============================================================================

# SENTRY_DSN=your_sentry_dsn
# PROMETHEUS_PORT=9090

# ============================================================================
# PRODUCTION CHECKLIST
# ============================================================================

# ✅ Changed DB_PASSWORD to strong random value
# ✅ Changed REDIS_PASSWORD to strong random value
# ✅ Generated NEW ENCRYPTION_KEY (not reused from dev)
# ✅ Using production Cloudflare account and tokens
# ✅ Created production R2 bucket (label-verify-prod)
# ✅ Scoped R2 tokens to production bucket only
# ✅ Set token expiration dates
# ✅ Backed up ENCRYPTION_KEY securely
# ✅ Set RUST_LOG to info (not debug)
# ✅ Configured production Azure AD app
# ✅ Reviewed all values for correctness
# ✅ Never committed this file to git

# ============================================================================
# QUICK DEPLOY
# ============================================================================

# 1. Copy this file:
#    cp .env.prod.example .env.prod

# 2. Fill in all values above

# 3. Build and start services:
#    docker compose --env-file .env.prod up -d

# 4. Check logs:
#    docker compose logs -f

# 5. Test API:
#    curl http://localhost:3000/health
